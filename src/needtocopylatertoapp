import React from 'react';
import './App.css';


//App component
const App = () => {
  const [state, setState] = useState(
    {
        posts: [],
        postsLoaded: false,
        loadMore: false         // Local state to global state
    }
)

const [globalState, setGlobalState] = useState(
   {
       userid: null,
       loggedIn: sessionStorage.getItem('jwt') ? 'true' : 'false' 
       //In line condition for staying logged in
       
   }
)

useEffect(()=>{  // This prevents from the fetch going to an infinite loop 
  if(!state.postsLoaded) { // Till this part

      // Make fetch request to backend
      fetch('http://localhost:3001/feed/all' )
      // Run .json() to convert the backend response
      .then(response => response.json())
      // Change the state for posts array
      .then(json=>{
          setState({ 
              ...state, 
              posts: json,
              postsLoaded: true
          }) 
          console.log(json)
      })
      .catch(e=>console.log('error', e))
  }
});

  return (
    
    
    
  );
}

export default App;
